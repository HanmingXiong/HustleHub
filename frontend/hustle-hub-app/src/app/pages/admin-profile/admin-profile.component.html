<div class="profile-container">
  <div *ngIf="isLoading" class="loading">Loading...</div>

  <div *ngIf="!isLoading && user" class="profile-content">
    <!-- Profile header -->
    <div class="profile-header">
      <div class="avatar">{{ getInitials() }}</div>
      <div class="header-info">
        <h1>{{ getFullName() }}</h1>
        <p>Administrator Account</p>
      </div>
      <button class="btn-edit" (click)="isEditMode = !isEditMode">
        {{ isEditMode ? 'Cancel' : 'Edit Profile' }}
      </button>
    </div>

    <!-- Basic info -->
    <div class="card">
      <h2>Basic Information</h2>
      <form [formGroup]="profileForm" (ngSubmit)="saveProfile()">
        <div class="form-grid">
          <div class="form-group">
            <label>Username</label>
            <input formControlName="username" [readonly]="!isEditMode">
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" formControlName="email" [readonly]="!isEditMode">
          </div>
          <div class="form-group">
            <label>First Name</label>
            <input formControlName="first_name" [readonly]="!isEditMode">
          </div>
          <div class="form-group">
            <label>Last Name</label>
            <input formControlName="last_name" [readonly]="!isEditMode">
          </div>
          <div class="form-group">
            <label>Phone</label>
            <input formControlName="phone" [readonly]="!isEditMode">
          </div>
        </div>
        <button *ngIf="isEditMode" type="submit" class="btn-primary" [disabled]="!profileForm.valid || isSaving">
          {{ isSaving ? 'Saving...' : 'Save Changes' }}
        </button>
      </form>
    </div>

    <!-- Company Information -->
    <div class="card">
      <div class="card-header">
        <h2>Company Information</h2>
        <button class="btn-edit" (click)="isEditCompanyMode = !isEditCompanyMode">
          {{ isEditCompanyMode ? 'Cancel' : 'Edit Company' }}
        </button>
      </div>
      <form [formGroup]="companyForm" (ngSubmit)="saveCompanyInfo()">
        <div class="form-grid">
          <div class="form-group">
            <label>Company Name *</label>
            <input formControlName="company_name" [readonly]="!isEditCompanyMode" placeholder="Enter company name">
          </div>
          <div class="form-group">
            <label>Location</label>
            <input formControlName="location" [readonly]="!isEditCompanyMode" placeholder="City, State">
          </div>
          <div class="form-group full-width">
            <label>Website</label>
            <input formControlName="website" [readonly]="!isEditCompanyMode" placeholder="https://company.com">
          </div>
          <div class="form-group full-width">
            <label>Description</label>
            <textarea formControlName="description" [readonly]="!isEditCompanyMode" rows="4" placeholder="Tell us about your company..."></textarea>
          </div>
        </div>
        <button *ngIf="isEditCompanyMode" type="submit" class="btn-primary" [disabled]="!companyForm.valid || isSavingCompany">
          {{ isSavingCompany ? 'Saving...' : 'Save Company Info' }}
        </button>
      </form>
    </div>

    <!-- Resume upload -->
    <div class="card">
      <h2>Resume</h2>
      <div *ngIf="!user.resume_file" class="upload-area">
        <p>ğŸ“„ Upload your resume (optional)</p>
        <label class="btn-upload">
          <input type="file" accept=".pdf,.doc,.docx" (change)="onFileSelected($event)" style="display: none;">
          {{ isUploadingResume ? 'Uploading...' : 'Choose File' }}
        </label>
        <small>PDF, DOC, or DOCX</small>
      </div>
      <div *ngIf="user.resume_file" class="resume-display">
        <div class="resume-info">
          <span class="resume-icon">ğŸ“„</span>
          <div>
            <strong>{{ getResumeFileName() }}</strong>
            <p>âœ“ Resume uploaded</p>
          </div>
        </div>
        <div class="resume-actions">
          <label class="btn-secondary">
            <input type="file" accept=".pdf,.doc,.docx" (change)="onFileSelected($event)" style="display: none;">
            Replace
          </label>
          <button class="btn-delete" (click)="deleteResume()">Delete</button>
        </div>
      </div>
    </div>

    <!-- Password change -->
    <div class="card">
      <h2>Change Password</h2>
      <div class="form-group">
        <label>Current Password</label>
        <div class="password-input">
          <input [type]="showCurrentPassword ? 'text' : 'password'" [(ngModel)]="currentPassword" placeholder="Enter current password">
          <button type="button" class="btn-toggle-password" (click)="showCurrentPassword = !showCurrentPassword">
            {{ showCurrentPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
      </div>
      <div class="form-group">
        <label>New Password</label>
        <div class="password-input">
          <input [type]="showNewPassword ? 'text' : 'password'" [(ngModel)]="newPassword" placeholder="Enter new password">
          <button type="button" class="btn-toggle-password" (click)="showNewPassword = !showNewPassword">
            {{ showNewPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
      </div>
      <div class="form-group">
        <label>Confirm New Password</label>
        <div class="password-input">
          <input [type]="showConfirmPassword ? 'text' : 'password'" [(ngModel)]="confirmPassword" placeholder="Confirm new password">
          <button type="button" class="btn-toggle-password" (click)="showConfirmPassword = !showConfirmPassword">
            {{ showConfirmPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
      </div>
      <button class="btn-primary" (click)="changePassword()" [disabled]="isChangingPassword">
        {{ isChangingPassword ? 'Changing...' : 'Change Password' }}
      </button>
    </div>

    <!-- Admin Info -->
    <div class="card admin-info">
      <h2>Administrator Access</h2>
      <p class="info-text">You have full access to manage users, jobs, and system settings.</p>
    </div>
  </div>

  <!-- Toast notification -->
  <div *ngIf="message" class="toast" [class.success]="messageType === 'success'" [class.error]="messageType === 'error'">
    {{ message }}
  </div>
</div>
