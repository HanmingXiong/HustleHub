<div class="container">
  
  <!-- Toast notification -->
  <div *ngIf="message" class="toast" [class.success]="messageType === 'success'" [class.error]="messageType === 'error'">
    {{ message }}
  </div>

  <header class="page-header">
    <h2>Available Jobs</h2>
  </header>

  <div class="search-section">
    <input 
      type="text" 
      placeholder="Search by Job Title..." 
      [(ngModel)]="searchTerm" 
      (input)="filterJobs()"
      class="search-input"
    >
    <input 
      type="text" 
      placeholder="Filter by Location..." 
      [(ngModel)]="searchLocation" 
      (input)="filterJobs()"
      class="search-input"
    >
  </div>

  <hr>

  <div class="job-list">
    <div *ngIf="filteredJobs.length === 0">
      <p>No active jobs found matching your criteria.</p>
    </div>

    <div *ngFor="let job of filteredJobs" class="job-card">
      <div class="job-header">
        <h3>{{ job.title }}</h3>
        <span class="job-type">{{ job.job_type }}</span>
      </div>
      
      <h4 class="company-name">{{ job.company_name }}</h4>
      
      <div class="job-details">
        <p><strong>Location:</strong> {{ job.location }}</p>
        <p><strong>Pay:</strong> {{ job.pay_range }}</p>
        <p><strong>Posted:</strong> {{ job.date_posted | date:'mediumDate' }}</p>
      </div>

      <p class="job-description">
        {{ job.description }}
      </p>

      <div class="job-actions" *ngIf="!isEmployer">
        <button 
          *ngIf="!job.has_applied" 
          class="btn-secondary" 
          (click)="navigateToApply(job.job_id)">
          Apply Now
        </button>
        <button 
          *ngIf="job.has_applied" 
          class="btn-applied" 
          disabled>
          âœ“ Applied
        </button>
        <button 
          *ngIf="job.has_applied" 
          class="btn-withdraw" 
          (click)="openWithdrawModal(job.job_id)">
          Withdraw
        </button>
      </div>
    </div>
  </div>

  <!-- Withdraw Confirmation Modal -->
  <div class="modal" *ngIf="showWithdrawModal" (click)="closeWithdrawModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <h3>Withdraw Application</h3>
      <p>Are you sure you want to withdraw your application? This action cannot be undone.</p>
      <div class="modal-actions">
        <button class="btn-secondary" (click)="closeWithdrawModal()">Cancel</button>
        <button class="btn-danger" (click)="confirmWithdraw()">Withdraw Application</button>
      </div>
    </div>
  </div>

</div>
